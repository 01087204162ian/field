<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>현장실습보험 관리 시스템</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/basic.css" rel="stylesheet">
	<link href="css/faq.css" rel="stylesheet">
	<link href="css/question.css" rel="stylesheet">
	<link href="css/question-modal.css" rel="stylesheet">
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="header-container">
            <div class="logo-section">
                <div class="logo">🏫</div>
                <div class="header-info">
                    <h1>현장실습보험 관리 시스템</h1>
                    <p>Field Work Insurance Management System</p>
                </div>
            </div>
            <div class="user-section">
				<div class="school-name" id="schoolName">
					<span class="loading"></span> 로딩 중...
				</div>
				<!-- 세션 정보 표시 추가 -->
				<div class="session-info" id="sessionInfo" style="display: none;">
					<span class="session-timer" id="sessionTimer">
						<i class="fas fa-clock"></i>
						<span id="remainingSessionTime">30:00</span>
					</span>
				</div>
				<div class="header-buttons">
					<!-- 세션 연장 버튼 추가 -->
					 <div class="header-buttons">
						<button class="extend-btn" onclick="AutoLogout.extend()" title="세션 연장">
							<i class="fas fa-clock"></i>
						</button>
						<button class="logout-btn" onclick="handleLogout()">로그아웃</button>
					</div>
				</div>
			</div>
        </div>
    </header>

    <!-- 메인 컨테이너 -->
    <main class="main-container">
        <!-- 환영 섹션 -->
      <!--  <section class="welcome-section fade-in">
            <h2 class="welcome-title">👋 관리자님, 안녕하세요!</h2>
            <p class="welcome-message">
                현장실습보험 관리 시스템에 오신 것을 환영합니다.<br>
                아래 메뉴를 통해 원하시는 서비스를 이용하세요.
            </p>
        </section>-->

        <!-- 메뉴 그리드 -->
        <div class="menu-grid" id="menuGrid">
            <!-- 현장실습보험 안내문 -->
            <div class="menu-card guide fade-in" onclick="goToPage('guide')" style="animation-delay: 0.1s">
                <div class="menu-icon">📋</div>
                <h3 class="menu-title">현장실습보험 안내문</h3>
                <p class="menu-description">
                    현장실습보험의 개요, 보장내용, 가입절차 등 전반적인 안내사항을 확인하세요.
                </p>
            </div>

            <!-- 신규 신청 -->
            <div class="menu-card application fade-in" onclick="goToPage('application')" style="animation-delay: 0.2s">
                <div class="menu-icon">➕</div>
                <h3 class="menu-title">신규 신청</h3>
                <p class="menu-description">
                    새로운 현장실습 및 보험 가입을 신청하고 학생 정보를 등록합니다.
                </p>
            </div>

            <!-- 질문서 리스트 -->
            <div class="menu-card questions fade-in" onclick="goToPage('questions')" style="animation-delay: 0.3s">
                <div class="menu-icon">📝</div>
                <h3 class="menu-title">질문서 리스트</h3>
                <p class="menu-description">
                    현장실습 관련 질문서 양식을 확인하고 작성된 질문서를 관리합니다.
                </p>
            </div>

            <!-- 처리절차 안내 -->
            <div class="menu-card process fade-in" onclick="goToPage('process')" style="animation-delay: 0.4s">
                <div class="menu-icon">🔄</div>
                <h3 class="menu-title">처리절차 안내</h3>
                <p class="menu-description">
                    현장실습보험 신청부터 보상까지의 전체 처리절차를 안내합니다.
                </p>
            </div>

            <!-- 자주 묻는 질문 -->
            <div class="menu-card faq fade-in" onclick="goToPage('faq')" style="animation-delay: 0.5s">
                <div class="menu-icon">❓</div>
                <h3 class="menu-title">자주 묻는 질문</h3>
                <p class="menu-description">
                    현장실습보험 관련하여 자주 묻는 질문과 답변을 확인하세요.
                </p>
            </div>

            <!-- 보상 안내 -->
            <div class="menu-card compensation fade-in" onclick="goToPage('compensation')" style="animation-delay: 0.6s">
                <div class="menu-icon">💰</div>
                <h3 class="menu-title">보상 안내</h3>
                <p class="menu-description">
                    사고 발생 시 보상절차, 보상범위, 필요서류 등을 안내합니다.
                </p>
            </div>

            <!-- 공지사항 -->
            <div class="menu-card notice fade-in" onclick="goToPage('notice')" style="animation-delay: 0.7s">
                <div class="menu-icon">📢</div>
                <h3 class="menu-title">공지사항</h3>
                <p class="menu-description">
                    시스템 업데이트, 중요 안내사항 등의 공지사항을 확인하세요.
                </p>
            </div>
        </div>

        <!-- 동적 콘텐츠 영역 -->
        <div id="contentArea" class="content-area" style="display: none;">
            <div class="content-header">
                <h2 id="contentTitle">페이지 제목</h2>
            </div>
            <div class="content-body">
                <div id="dynamicContent">
                    <!-- 동적 콘텐츠가 여기에 로드됩니다 -->
                </div>
            </div>
        </div>
    </main>

    <!-- Floating Menu Button -->
    <button class="floating-menu-btn" id="floatingMenuBtn" onclick="showMainMenu()" title="메인메뉴로 돌아가기">
        🏠
    </button>

    <script>
        // === 전역 변수 ===
        let currentPage = 'main';
        let schoolData = null;

        // === 초기화 함수 ===
        document.addEventListener('DOMContentLoaded', function() {
			  // 먼저 세션 체크
			if (!validateSession()) {
				return;
			}
			
			// 자동 로그아웃 관리자 초기화 (새로 추가)
			initAutoLogout();
    
			// 기존 초기화 함수들
            initializeSystem();
            loadSchoolInfo();
        });

        // === 시스템 초기화 ===
        function initializeSystem() {
            console.log('현장실습보험 관리 시스템 초기화 중...');
            
            // 메뉴 카드에 호버 효과 추가
            addMenuHoverEffects();
            
            // 스크롤 이벤트 추가
            addScrollEffects();
            
            console.log('시스템 초기화 완료');
        }
		// === 자동 로그아웃 설정 개선 ===
function initAutoLogout() {
    const isDevelopment = window.location.hostname === 'localhost' || 
                        window.location.hostname === '127.0.0.1';
    
    const config = {
        autoLogoutTime: 2 * 60 * 60 * 1000,    // 2시간으로 연장
        warningTime: 10 * 60 * 1000,           // 10분 전 경고
        checkInterval: 5 * 60 * 1000,          // 5분마다 체크로 변경
        debug: isDevelopment,
        serverCheckInterval: 0,
        // 세션 연장 가능하도록 설정
        allowExtension: true,
        maxExtensions: 3  // 최대 3번까지 연장 가능
    };
    
    // 자동 로그아웃 관리자가 있는 경우에만 초기화
    if (typeof AutoLogout !== 'undefined') {
        AutoLogout.init(config);
        startSessionTimerUI();
        console.log('자동 로그아웃 기능이 활성화되었습니다.');
    } else {
        console.warn('AutoLogout 관리자를 찾을 수 없습니다.');
    }
}
// === 서버 세션 확인 함수 추가 ===
async function checkServerSession() {
    try {
        const cNum = sessionStorage.getItem('cNum');
        const mem_id = sessionStorage.getItem('mem_id');
        
        if (!cNum || !mem_id) {
            return false;
        }
        
        const response = await fetch('https://silbo.kr/2025/api/teacher/check_session.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                cNum: cNum,
                mem_id: mem_id
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            console.log('서버 세션 확인 완료');
            return true;
        } else {
            console.log('서버 세션 확인 실패:', result.message);
            return false;
        }
        
    } catch (error) {
        console.error('서버 세션 확인 오류:', error);
        // 네트워크 오류인 경우 세션을 유지
        return true;
    }
}

// === 로그인 시 세션 정보 저장 개선 ===
function saveLoginSession(data) {
    const loginTime = Date.now().toString();
    
    // 기존 세션 정보 저장
    if (data.cNum) sessionStorage.setItem('cNum', data.cNum);
    if (data.schoolName) sessionStorage.setItem('schoolName', data.schoolName);
    if (data.mem_id) sessionStorage.setItem('mem_id', data.mem_id);
    if (data.damdanga) sessionStorage.setItem('damdanga', data.damdanga);
    if (data.damdangat) sessionStorage.setItem('damdangat', data.damdangat);
    if (data.directory) sessionStorage.setItem('directory', data.directory);
    
    // 추가 세션 정보
    sessionStorage.setItem('loginTime', loginTime);
    sessionStorage.setItem('lastActivity', loginTime);
    sessionStorage.setItem('sessionValid', 'true');
    
    console.log('로그인 세션 저장 완료:', data);
}

// === 사용자 활동 추적 ===
function trackUserActivity() {
    const events = ['click', 'keypress', 'scroll', 'mousemove'];
    
    events.forEach(event => {
        document.addEventListener(event, debounce(() => {
            sessionStorage.setItem('lastActivity', Date.now().toString());
        }, 30000)); // 30초마다 한 번만 업데이트
    });
}

// === 세션 복구 시도 ===
async function attemptSessionRecovery() {
    try {
        const cNum = sessionStorage.getItem('cNum');
        const mem_id = sessionStorage.getItem('mem_id');
        
        if (!cNum || !mem_id) {
            return false;
        }
        
        // 서버에 세션 확인 요청
        const isServerSessionValid = await checkServerSession();
        
        if (isServerSessionValid) {
            // 서버 세션이 유효하면 클라이언트 세션 복구
            sessionStorage.setItem('sessionValid', 'true');
            sessionStorage.setItem('lastActivity', Date.now().toString());
            
            showNotification('세션이 복구되었습니다.', 'success');
            return true;
        }
        
        return false;
        
    } catch (error) {
        console.error('세션 복구 시도 중 오류:', error);
        return false;
    }
}

			// 세션 타이머 UI 업데이트 함수 추가
			function startSessionTimerUI() {
				const sessionInfo = document.getElementById('sessionInfo');
				const timerElement = document.getElementById('remainingSessionTime');
				
				if (!sessionInfo || !timerElement) return;
				
				sessionInfo.style.display = 'block';
				
				setInterval(() => {
					const info = AutoLogout.getInfo();
					if (info && info.isActive) {
						const minutes = Math.floor(info.remainingTime / 60);
						const seconds = info.remainingTime % 60;
						const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
						
						timerElement.textContent = timeString;
						
						// 5분 이하일 때 경고 색상
						if (info.remainingTime <= 300) {
							timerElement.style.color = '#ef4444';
							timerElement.style.animation = 'pulse 1s infinite';
						} else {
							timerElement.style.color = '#10b981';
							timerElement.style.animation = 'none';
						}
					}
				}, 1000);
			}
        // === 학교 정보 로드 ===
        function loadSchoolInfo() {
            // 세션 정보 확인
            const cNum = sessionStorage.getItem('cNum');
            const schoolName = sessionStorage.getItem('schoolName');
            const mem_id = sessionStorage.getItem('mem_id');
            const damdanga = sessionStorage.getItem('damdanga');
            const damdangat = sessionStorage.getItem('damdangat');
            const directory = sessionStorage.getItem('directory');
            
            if (!cNum || !schoolName) {
                // 로그인 정보가 없으면 로그인 페이지로 리다이렉트
                showNotification('로그인이 필요합니다.', 'error');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
                return;
            }
			
            // 세션 정보로 학교 정보 설정
            const schoolInfo = {
                name: schoolName,
                cNum: cNum,
                mem_id: mem_id,
                admin: damdanga || '관리자',
                adminTel: damdangat || '',
                type: directory === '1' ? '대학교' : directory === '2' ? '고등학교' : '학교'
            };
            
            // 헤더에 학교 정보 표시
            const schoolNameElement = document.getElementById('schoolName');
            schoolNameElement.innerHTML = `${schoolInfo.type} ${schoolInfo.name} (${schoolInfo.admin})`;
            if (schoolInfo.adminTel) {
                schoolNameElement.title = `연락처: ${schoolInfo.adminTel}`;
            }
            
            schoolData = schoolInfo;
            
            // 환영 메시지 개인화
            updateWelcomeMessage(schoolInfo);
            
            console.log('로그인 정보 로드 완료:', schoolInfo);
        }

        // === 보상한도 업데이트 함수 ===
        function updateCompensationLimits(directory) {
            const liabilityA = document.getElementById('liability-a');
            const liabilityB = document.getElementById('liability-b');
            const workersCompA = document.getElementById('workers-comp-a');
            const workersCompB = document.getElementById('workers-comp-b');

            // 모든 요소가 존재하는지 확인
            if (!liabilityA || !liabilityB || !workersCompA || !workersCompB) {
                console.log('보상한도 업데이트: 필요한 DOM 요소를 찾을 수 없습니다.');
                return;
            }

            const isUniversity = directory === '1';
            
            // 대인 및 대물 배상책임
            liabilityA.textContent = `사고당 ${isUniversity ? '2' : '1'}억원`;
            liabilityB.textContent = `사고당 ${isUniversity ? '3' : '2'}억원`;
            
            // 산재보험 초과 배상책임
            workersCompA.textContent = `사고당 ${isUniversity ? '2' : '1'}억원`;
            workersCompB.textContent = `사고당 ${isUniversity ? '3' : '2'}억원`;
        }

        // === 페이지 콘텐츠 로드 ===
        function loadPageContent(pageId) {
            const contentTitle = document.getElementById('contentTitle');
            const dynamicContent = document.getElementById('dynamicContent');
            
            const pageInfo = getPageInfo(pageId);
            contentTitle.textContent = pageInfo.title;
            dynamicContent.innerHTML = pageInfo.content;

            if (pageId === 'guide') {
                loadPremiumData();
                setTimeout(() => {
                    const directory = sessionStorage.getItem('directory');
                    updateCompensationLimits(directory);
                }, 0);
            } else if (pageId === 'application') {
                setTimeout(() => {
                    const directory = sessionStorage.getItem('directory');
                    updateInsuranceTable(directory);


                    // 수정된 코드
					setTimeout(() => {
						if (typeof initApplicationPage === 'function') {
							initApplicationPage();
						} else {
							console.log('quote.js가 아직 로드되지 않았습니다.');
							// quote.js가 로드되지 않은 경우 직접 호출
							if (typeof generateParticipantsTable === 'function') {
								generateParticipantsTable();
							}
						}
					}, 500); // 지연 시간 증가


                }, 0);
            } else if (pageId === 'questions') {
                loadQuestionScript().then(() => {
        if (typeof initQuestionsManager === 'function') {
            initQuestionsManager();
        }
        if (typeof loadQuestionsList === 'function') {
            loadQuestionsList();
        }
    }).catch((error) => {
        console.error('질문서 스크립트 로드 실패:', error);
        showNotification('질문서 기능을 로드할 수 없습니다.', 'error');
    });
            }
        }

        // === 보험료 데이터 로드 ===
        async function loadPremiumData() {
            try {
                const premiumLoading = document.getElementById('premium-loading');
                const premiumContent = document.getElementById('premium-content');
                const premiumTableBody = document.getElementById('premium-table-body');
                const lastUpdatedElement = document.getElementById('last-updated');

                if (!premiumLoading || !premiumContent || !premiumTableBody) {
                    console.error('보험료 관련 DOM 요소를 찾을 수 없습니다.');
                    return;
                }

                premiumLoading.style.display = 'block';
                premiumContent.style.display = 'none';

                const response = await fetch('api/premium.php');
                const data = await response.json();

                if (data.success) {
                    // 숫자 형식 변환 함수
                    const formatNumber = (str) => {
                        // "3,000원" 형식의 문자열에서 숫자만 추출
                        const num = parseInt(str.replace(/[^0-9]/g, ''));
                        // 천 단위 구분자로 포맷팅
                        return num.toLocaleString();
                    };

                    const tableRows = data.periods.map(period => `
                        <tr>
                            <td class="text-center">${period.weeks}</td>
                            <td class="text-end">${formatNumber(period.planA)}</td>
                            <td class="text-end">${formatNumber(period.planB)}</td>
                        </tr>
                    `).join('');

                    premiumTableBody.innerHTML = tableRows;
                    premiumLoading.style.display = 'none';
                    premiumContent.style.display = 'block';
                } else {
                    throw new Error('데이터를 불러오는데 실패했습니다.');
                }
            } catch (error) {
                console.error('보험료 데이터 로드 오류:', error);
                const premiumLoading = document.getElementById('premium-loading');
                if (premiumLoading) {
                    premiumLoading.innerHTML = `
                        <div class="alert alert-danger" role="alert">
                            <p>😢 보험료 데이터를 불러오는데 실패했습니다.</p>
                            <button class="btn btn-outline-danger mt-2" onclick="loadPremiumData()">다시 시도</button>
                        </div>
                    `;
                }
            }
        }

        // === 페이지 네비게이션 ===
        function goToPage(pageId) {
            // 권한 체크
            if (!validateSession()) {
                return;
            }
            
            console.log(`페이지 이동: ${pageId}`);
            
            // 메인 메뉴 숨기기
            //document.querySelector('.welcome-section').style.display = 'none';
            document.getElementById('menuGrid').style.display = 'none';
            
            // 콘텐츠 영역 표시
            const contentArea = document.getElementById('contentArea');
            contentArea.style.display = 'block';
            contentArea.classList.add('fade-in');
            
            // 플로팅 버튼 표시
            document.getElementById('floatingMenuBtn').style.display = 'block';
            
            // 페이지별 콘텐츠 로드
            loadPageContent(pageId);
            
            // 현재 페이지 업데이트
            currentPage = pageId;
            
            // 상단으로 스크롤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
		function loadQuestionScript() {
    return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = 'js/questionListSearch.js';
        script.onload = () => {
            console.log('questionListSearch.js 로드 완료');
            resolve();
        };
        script.onerror = () => {
            console.error('questionListSearch.js 로드 실패');
            reject(new Error('Script load failed'));
        };
        document.head.appendChild(script);
    });
}
        // === 메인 메뉴 표시 ===
        function showMainMenu() {
            console.log('메인 메뉴로 돌아가기');
            
            // 콘텐츠 영역 숨기기
            document.getElementById('contentArea').style.display = 'none';
            
            // 메인 메뉴 표시
            //document.querySelector('.welcome-section').style.display = 'block';
            document.getElementById('menuGrid').style.display = 'grid';
            
            // 플로팅 버튼 숨기기
            document.getElementById('floatingMenuBtn').style.display = 'none';
            
            // 현재 페이지 업데이트
            currentPage = 'main';
            
            // 상단으로 스크롤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // === 페이지 정보 반환 ===
        function getPageInfo(pageId) {
            const pages = {
                guide: {
                    title: '📋 현장실습보험 안내문',
                    content: `
                       

                        <div id="guide-content">
                            <div class="guide-section">
                                <h3>1. 상품개발 배경</h3>
                                <div class="content-text">
                                    교육부 고시 제 2016-89호 "현장실습 운영규정" 등에서 정하는 학생보호에 대한 규정을 지원하기 위해 본 상품 개발
                                </div>
                                <ul class="guide-list">
                                    <li>학생의 현장실습 중 발생한 치료비를 보상</li>
                                    <li>학생의 현장실습 중 과실로 인한 법률상의 배상책임 보상</li>
                                    <li>실습기관의 과실로 현장실습중인 학생에 대한 법률상의 배상책임 보상</li>
                            </ul>
                            </div>

                            <div class="guide-section">
                                <h3>2. 상품의 특징</h3>
                                <ul class="guide-list">
                                    <li>보험가입 시 참여학생의 이름 및 주민번호 없이 보험가입가능</li>
                                    <li>개인이 가입한 실손의료비와 무관하게 중복으로 치료비 지급, 보상한도 1천만원</li>
                                    <li>현장실습 중 학생의 과실에 따른 배상책임, 실습기관의 배상책임을 교차하여 담보</li>
                                    <li>보험계약자 - 대학교(고등학교)또는 대학교(고등학교) 산학협력팀 / 피보험자 - 참여학생 및 실습기관</li>
                                </ul>
                            </div>

                            <div class="guide-section">
                                <h3>3. ※ 왜 (산재사고) 사용자배상책임 보장이 필요한가?</h3>
                                <div class="table-responsive">
                                    <table class="guide-table">
                                        <thead>
                                            <tr>
                                                <th>구분</th>
                                                <th>산재보험</th>
                                                <th>사용자배상책임보험</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="row-header">보험성격</td>
                                                <td>산재보험</td>
                                                <td>임의보험</td>
                                            </tr>
                                            <tr>
                                                <td class="row-header">보장내용</td>
                                                <td>과실여부와 상관없이 업무상의 재해보상</td>
                                                <td>사용자의 과실에 의한 것으로 산재법상의 재해보상을 초과하는 민법상 손해배상</td>
                                            </tr>
                                            <tr>
                                                <td class="row-header">성립요건</td>
                                                <td>사용자의 무과실 책임</td>
                                                <td>사용자의 고의 또는 과실책임</td>
                                            </tr>
                                            <tr>
                                                <td class="row-header">보상범위</td>
                                                <td>요양보상, 휴업보상, 장해보상, 유족보상, 장제비<br>(요양보상은 실손보상, 나머지는 평균임금의 일정부분을 지급)</td>
                                                <td>보상한도 내에서 적극적손해, 소극적손해, 위자료로 구분하여 완전배상하며, 정신적•육체적 손해를 포함<br>예) 산재초과 상실 수익금, 향후치료비, 위자료, 소송비용</td>
                                            </tr>
                                            <tr>
                                                <td class="row-header">상계처리</td>
                                                <td>무과실책임</td>
                                                <td>근로자와 사용자의 과실을 상계하며 지급받은 산재보험금을 공제함</td>
                                            </tr>
                                            <tr>
                                                <td class="row-header">근거법령</td>
                                                <td>산재보험법 및 근로기준법</td>
                                                <td>민법 및 상법</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="guide-section">
                                <h3>4. 상품의 구성</h3>
                                <div class="table-responsive">
                                    <table class="guide-table table-striped table-bordered">
                                        <thead class="table-primary">
                                            <tr>
                                                <th rowspan="2" class="text-center align-middle">구분</th>
                                                <th colspan="2" class="text-center">가입유형별 보상한도</th>
                                            </tr>
                                            <tr>
                                                <th class="text-center">가입유형 A</th>
                                                <th class="text-center">가입유형 B</th>
                                            </tr>
                                        </thead>
                                        <tbody id="compensation-table-body">
                                            <tr>
                                                <td class="text-center"><strong>(대인 및 대물) 배상책임</strong></td>
                                                <td class="text-center" id="liability-a">사고당 2억원</td>
                                                <td class="text-center" id="liability-b">사고당 3억원</td>
                                            </tr>
                                            <tr>
                                                <td class="text-center"><strong>(산재보험 초과) 배상책임</strong></td>
                                                <td class="text-center" id="workers-comp-a">사고당 2억원</td>
                                                <td class="text-center" id="workers-comp-b">사고당 3억원</td>
                                            </tr>
                                            <tr>
                                                <td class="text-center"><strong>(실습중) 치료비</strong></td>
                                                <td class="text-center">1인당 1천만원</td>
                                                <td class="text-center">1인당 1천만원</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-3">
                                    <p class="text-primary mb-2"><strong>※ 보험 증권당 총 보상한도 10억원</strong></p>
                                    <p class="text-danger"><strong>※ 배상책임 자기부담금 1사고당 10만원 / 치료비 자기부담금 없음</strong></p>
                                </div>
                            </div>

                            <div class="guide-section" id="premium-section">
                                <h3>5. 보험료</h3>
                                <div id="premium-loading" style="text-align: center; padding: 20px;">
                                    <p>📡 보험료 데이터를 불러오는 중...</p>
                                </div>
                                <div id="premium-content" style="display: none;">
                                    <div class="table-responsive">
                                        <table class="guide-table table-striped table-bordered">
                                            <thead class="table-primary">
                                                <tr>
                                                    <th class="text-center" style="width: 33%">실습기간</th>
                                                    <th class="text-center" style="width: 33%">가입유형 A</th>
                                                    <th class="text-center" style="width: 33%">가입유형 B</th>
                                                </tr>
                                            </thead>
                                            <tbody id="premium-table-body">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                application: {
                    title: '➕ 현장실습보험 견적의뢰',
                    content: `
                        <div id="quote-page" style="padding-top: 20px;">
                            <div class="container">
                                <!-- 개선된 안내 메시지 -->
                                <!--<div class="guide-section">
                                    <div class="alert-enhanced">
                                        <p class="mb-2" style="color: #495057; font-size: 1.05rem; line-height: 1.7;">본 질문서는 보험료 산출을 위한 중요한 자료로 활용됩니다.</p>
                                        <p class="mb-0" style="color: #495057; font-size: 1.05rem; line-height: 1.7;">사실과 다를 경우 보험금 지급 시 영향을 미칠 수 있사오니 정확하게 작성해 주시기 바랍니다.</p>
                                    </div>
                                </div>->

                                <!-- 개선된 폼 컨테이너 -->
                                <div class="form-container">
                                    <div class="quote-form-enhanced">
                                        <form id="quoteForm">
                                            <!-- 1. 계약자 정보 -->
                                            <div class="form-section mb-5">
                                                <div class="form-section-header">
                                                    <h4>
                                                        <div class="contractor-title">
                                                            <i class="fas fa-university"></i>
                                                            1. 계약자 정보
                                                        </div>
                                                        <small class="contractor-subtitle">(대학교 또는 산학협력단)</small>
                                                    </h4>
                                                </div>
                                                
                                                <div class="form-grid-enhanced">
                                                    <!-- 사업자번호와 계약자명을 한 행에 -->
                                                    <div class="form-row-inline">
                                                        <div class="form-group">
                                                            <label for="business_number">사업자번호 <span class="required-asterisk">*</span></label>
                                                            <input type="text" class="form-control-white" 
                                                                   name="business_number" id="business_number"
                                                                   placeholder="하이픈 없이 번호만 입력" maxlength="10" required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="institution_name">계약자 <span class="required-asterisk">*</span></label>
                                                            <input type="text" class="form-control-white" 
                                                                   name="institution_name" id="institution_name"
                                                                   placeholder="학교명을 입력해주세요" required>
                                                        </div>
                                                    </div>

                                                    <!-- 주소는 한 행 전체 사용 -->
                                                    <div class="form-row-single">
                                                        <div class="form-group address-group">
                                                            <label for="address">주소 <span class="required-asterisk">*</span></label>
                                                            <textarea class="form-control-white" 
                                                                      name="address" id="address"
                                                                      placeholder="상세주소를 포함하여 입력해주세요" required rows="2"></textarea>
                                                        </div>
                                                    </div>

                                                    <!-- 연락처와 이메일을 한 행에 -->
                                                    <div class="form-row-inline">
                                                        <div class="form-group">
                                                            <label for="phone">연락처 <span class="required-asterisk">*</span></label>
                                                            <input type="tel" class="form-control-white" 
                                                                   name="phone" id="phone"
                                                                   placeholder="하이픈 없이 번호만 입력" required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="email">이메일 <span class="required-asterisk">*</span></label>
                                                            <input type="email" class="form-control-white" 
                                                                   name="email" id="email"
                                                                   placeholder="example@school.ac.kr" required>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 2. 현장실습 관련 사항 -->
                                            <div class="form-section mb-5">
                                                <div class="form-section-header">
                                                    <h4>
                                                        <i class="fas fa-clipboard-list"></i>2. 현장실습 관련 사항
                                                    </h4>
                                                </div>
                                                
                                                <div class="form-grid-enhanced">
                                                    <div class="form-row-inline">
													   <div class="form-group">
                                                        <label class="form-label-enhanced mb-3">
                                                            현장실습시기 <span class="required-asterisk">*</span>
                                                        </label>
                                                        <div class="radio-group-enhanced d-flex flex-wrap gap-3">
                                                            <div class="form-check-enhanced">
                                                                <input class="form-check-input" type="radio" name="season" value="1" id="season1">
                                                                <label class="form-check-label" for="season1">1학기</label>
                                                            </div>
                                                            <div class="form-check-enhanced">
                                                                <input class="form-check-input" type="radio" name="season" value="2" id="season2">
                                                                <label class="form-check-label" for="season2">하계계절</label>
                                                            </div>
                                                            <div class="form-check-enhanced">
                                                                <input class="form-check-input" type="radio" name="season" value="3" id="season3">
                                                                <label class="form-check-label" for="season3">2학기</label>
                                                            </div>
                                                            <div class="form-check-enhanced">
                                                                <input class="form-check-input" type="radio" name="season" value="4" id="season4">
                                                                <label class="form-check-label" for="season4">동계계절</label>
                                                            </div>
                                                        </div>
													 </div>
                                                    </div>

                                                    <div class="form-row-inline">
                                                        <div class="form-group">
                                                            <label for="start_date">보험 시작일 <span class="required-asterisk">*</span></label>
                                                            <input type="date" class="form-control form-control-white" 
                                                                   name="start_date" id="start_date" required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="end_date">보험 종료일 <span class="required-asterisk">*</span></label>
                                                            <input type="date" class="form-control form-control-white" 
                                                                   name="end_date" id="end_date" required>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 3. 보험가입 유형 선택 -->
                                            <div class="form-section mb-5">
                                                <div class="form-section-header">
                                                    <h4>
                                                        <i class="fas fa-shield-alt"></i>3. 보험가입 유형 선택
                                                    </h4>
                                                </div>
                                                
                                                <div class="table-responsive">
                                                    <table class="table table-enhanced" id="coverage-table">
                                                        <thead>
                                                            <tr>
                                                                <th width="30%" class="text-center">보장내용</th>
                                                                <th width="35%" class="text-center">
                                                                    <div class="form-check">
                                                                        <input class="form-check-input" type="radio" name="plan" value="A" id="planA">
                                                                        <label class="form-check-label plan-type-cell" data-plan="A" for="planA">가입유형 A</label>
                                                                    </div>
                                                                </th>
                                                                <th width="35%" class="text-center">
                                                                    <div class="form-check">
                                                                        <input class="form-check-input" type="radio" name="plan" value="B" id="planB">
                                                                        <label class="form-check-label plan-type-cell" data-plan="B" for="planB">가입유형 B</label>
                                                                    </div>
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td class="text-center fw-bold liability-cell">
                                                                    <span>(대인 및 대물) 배상책임</span>
                                                                </td>
                                                                <td class="text-center amount-cell billion" data-amount="2">
                                                                    <span>사고당 2억원</span>
                                                                </td>
                                                                <td class="text-center amount-cell billion" data-amount="3">
                                                                    <span>사고당 3억원</span>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-center fw-bold workers-comp-cell">
                                                                    <span>(산재보험 초과) 배상책임</span>
                                                                </td>
                                                                <td class="text-center amount-cell billion" data-amount="2">
                                                                    <span>사고당 2억원</span>
                                                                </td>
                                                                <td class="text-center amount-cell billion" data-amount="3">
                                                                    <span>사고당 3억원</span>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-center fw-bold">(실습중) 치료비</td>
                                                                <td class="text-center amount-cell million">
                                                                    <span>1인당 1천만원</span>
                                                                </td>
                                                                <td class="text-center amount-cell million">
                                                                    <span>1인당 1천만원</span>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>

                                            <!-- 4. 실습기간별 참여인원 -->
                                            <div class="form-section mb-5">
                                                <div class="form-section-header">
                                                    <h4>
                                                        <i class="fas fa-users"></i>4. 실습기간별 참여인원
                                                    </h4>
                                                </div>
                                                
                                                <div class="table-responsive">
                                                    <table class="table table-enhanced participants-table">
                                                        <thead>
                                                            <tr>
                                                                <th width="20%" class="text-center" data-title="실습기간">실습기간</th>
                                                                <th width="30%" class="text-center" data-title="참여인원">참여인원</th>
                                                                <th width="20%" class="text-center" data-title="실습기간">실습기간</th>
                                                                <th width="30%" class="text-center" data-title="참여인원">참여인원</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="participants-table-body">
                                                            <!-- 참여인원 테이블 내용은 JavaScript로 동적 생성 -->
                                                        </tbody>
                                                        <tfoot>
                                                            <tr>
                                                                <th colspan="3" class="text-center">총 참여인원 수</th>
                                                                <th class="text-center">
                                                                    <span id="totalParticipants" class="total-participants">0</span> 명
                                                                </th>
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>

                                            <!-- 5. 추가 정보 -->
                                            <div class="form-section mb-4">
                                                <div class="form-section-header">
                                                    <h4>
                                                        <i class="fas fa-plus-circle"></i>5. 추가 정보
                                                    </h4>
                                                </div>
                                                
                                                <div class="form-grid-enhanced">
                                                    <div class="form-row-single">
                                                        <label for="teacher_name">담당자명 <span class="required-asterisk">*</span></label>
                                                        <input type="text" class="form-control-white" 
                                                               name="teacher_name" id="teacher_name"
                                                               placeholder="담당자 성함을 입력해주세요" required>
                                                    </div>
                                                    
                                                    <div class="form-row-single">
                                                        <label for="special_notes">특이사항 및 요청사항</label>
                                                        <textarea class="form-control-white" rows="4" 
                                                                  name="special_notes" id="special_notes"
                                                                  placeholder="실습 중 특별히 주의해야 할 사항이나 요청사항을 입력해주세요." 
                                                                  style="min-height: 120px; resize: vertical;"></textarea>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 제출 버튼 -->
                                            <div class="submit-section text-center">
                                                <button type="button" class="btn-submit-enhanced" onclick="handleQuoteSubmit(event)">
													<i class="fas fa-paper-plane"></i> 견적 요청하기
												</button>
                                                <p class="text-muted mt-3 mb-0">
                                                    <i class="fas fa-shield-alt me-1"></i>
                                                    귀하의 정보는 안전하게 보호되며, 견적 산출 목적으로만 사용됩니다.
                                                </p>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
               // 기존 getPageInfo 함수에서 questions 부분을 이것으로 교체하세요
					questions: {
						title: '📝 질문서 리스트',
						content: `
							<div class="container">
								<!-- 검색 섹션 -->
								<div class="search-section fade-in">
									<form class="search-form" onsubmit="handleSearch(event)">
										<div class="search-group">
											<label for="searchSchool">학교명 검색</label>
											<input 
												type="text" 
												id="searchSchool" 
												class="search-input" 
												placeholder="학교명을 입력하세요"
												value=""
											>
										</div>
										<button type="submit" class="search-btn">
											<i class="fas fa-search"></i>
											검색
										</button>
										<button type="button" class="reset-btn" onclick="resetSearch()">
											<i class="fas fa-times"></i>
											초기화
										</button>
									</form>
								</div>

								<!-- 로딩 상태 -->
								<div id="questionsLoading" class="loading-container fade-in">
									<div class="loading-spinner"></div>
									<p>질문서 목록을 불러오는 중...</p>
								</div>
								
								<!-- 질문서 그리드 -->
								<div id="questionsGrid" class="questions-grid fade-in" style="display: none;">
									<!-- 동적으로 생성되는 카드들 -->
								</div>
								
								<!-- 데이터 없음 메시지 -->
								<div id="noDataMessage" class="no-data fade-in" style="display: none;">
									<i class="fas fa-inbox"></i>
									<h3>등록된 질문서가 없습니다</h3>
									<p>새로운 현장실습보험을 신청해보세요.</p>
								</div>
								
								<!-- 페이지네이션 -->
								<div id="questionsPagination" class="pagination-container fade-in" style="display: none;">
									<div class="pagination-info">
										<span id="paginationInfo">전체 0개 (1/1 페이지)</span>
									</div>
									<div class="pagination-buttons" id="paginationButtons">
										<!-- 동적으로 생성되는 페이지 버튼들 -->
									</div>
								</div>
							</div>
						`
					},
                process: {
                    title: '🔄 처리절차 안내',
                    content: `
						<div id="guide-content">
                            <div class="guide-section">
                                <h3>1. 견적의뢰 신청</h3>
                                <div class="content-text">홈페이지 "견적의뢰" 내용 작성 및 신청</div>
                               
                            </div>

                            <div class="guide-section">
                                <h3>2. 담당자 메일 송신</h3>
									<div class="content-text">업무 담당자가 신청 선생님께 메일 송신</div>
									<div class="content-text">진행 내용을 확인할 수 있는 담당자 전용 사이트 주소와 로그인 정보를 메일로 전달드립니다.</div>
									<div class="content-text">메일로 제공되는 내용:</div>
										<ul class="guide-list">
											<li>의뢰한 내용 확인</li>
											<li>보험료 확인 및 청약서 출력</li>
											<li> 질문서 출력 </li>
											<li>과별인원 작성</li>
										</ul>
                            </div>

                              <div class="guide-section">
                                <h3>3. 관리사이트 로그인</h3>
								<div class="content-text"> 담당자 선생님 관리사이트 로그인 후 필요 서류 준비</div>
								<div class="content-text">질문서, 청약서 다운로드하여 내용 확인 후 신청 내용 일치하면 직인 날인</div>
				                <div class="content-text"> 학과별 참여 인원 현황(예시 파일)</div>
				                <div class="content-text">결제 방식을 선택</div>
										<ul class="guide-list">
											<li>현금이면 가상계좌로 입금 (청약서 가상계좌)</li>
											<li>카드이면 카드번호 유효기간</li>
										</ul>
                            </div>
							
							<div class="guide-section">
                                <h3>4. 보험료 결제 처리</h3>
				                <div class="content-text">이투엘 현장실습보험 담당자가 보험료 결제</div>
				                <div class="content-text">현금이면 입금 확인, 카드이면 카드승인 후 수납하여 영수증, 증권발급하여 관리사이트에 업로드 하고 메일을 드립니다.</div>
                            </div>
			             
						  <div class="guide-section">
                                <h3>5. 주요 안내사항</h3>
									<div class="content-text">입금 또는 카드 승인을 받기 전까지는 질문서를 수정 가능합니다.</div>
				                    <div class="content-text">증권발급 후 참여인원 등의 변경사항이 발생하면 신규추가로 처리하시면 됩니다.</div>
				                   <div class="content-text">실습기간이 2016.09.01부터 2016.12.23일 경우</div>
				                  <div class="content-text">보험기간은 2016.09.01 01:00부터 2016.12.24 01:00까지입니다.<br>
                                     <small>(보험증권의 종료일은 실습기간의 마지막날보다 하루 더 길게 표시)</small>
                                  </div>
                            </div>  
                        </div>

                    `
                },
                faq: {
                    title: '❓ 자주 묻는 질문',
                    content: `
						<div class="container">
							
							<div class="row justify-content-center">
								<div class="col-lg-10">
									<div class="accordion" id="faqAccordion">
										
										<!-- Q1 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1" data-question="Q1">
													 보험가입시 이름과 주민번호 없이 보험에 가입하는데 보상에 문제가 없나요?
												</button>
											</h2>
											<div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p><strong>보상처리에 전혀 문제가 되지 않습니다.</strong></p>
													<p>사고로 보험금을 청구할 때 현장실습에 참여하고 있었음을 증명하는 서류를 함께 제출해야 하기 때문입니다.</p>
													<p class="text-primary">(실습기관의 출석부 및 대학교 현장실습 전산에서 '참여학생정보 화면 캡쳐')</p>
													<div class="highlight">
														<p><strong>유사한 다른 보험의 사례:</strong><br>
														대학교가 재학생의 학교생활 중 사고를 보장해주는 "학교경영자배상책임보험"이 있습니다. 이 보험에서도 이름과 주민번호 없이 보험가입 시점의 재학생수를 기준으로 보험가입 합니다. 단, 사고발생시에는 재학중임을 증명하는 '재학증명서'를 반드시 제출해야 합니다.</p>
													</div>
												</div>
											</div>
										</div>

										<!-- Q2 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2" data-question="Q2">
													 실습을 중도에 포기하거나, 중단해야 할 경우 보험료를 환급 받을 수 있나요?
												</button>
											</h2>
											<div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p><strong>학생 개개인의 사유로 실습을 중도에 포기하거나 중단하는 경우 보험료를 환급해주지 않습니다.</strong></p>
													<p>단, 이번과 같은 코로나 팬데믹 상황, 자연재해 등으로 학과 전체가 실습을 중단하는 경우 또는 합리적 이유로 학과 전체의 실습이 중단 취소되는 경우에는 보험을 해지하고 해지에 따른 보험료를 환급해 드립니다.</p>
													<div class="highlight">
														<p><strong>유사한 다른 보험의 사례:</strong><br>
														대학교가 재학생의 학교생활 중 사고를 보장해주는 "학교경영자배상책임보험"이 있습니다. 이 보험에서도 중도 휴학, 퇴학 등의 학업중단 상황이 발생해도 개개인의 사유에 따른 보험료 환급은 없습니다.</p>
													</div>
												</div>
											</div>
										</div>

										<!-- Q3 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3" data-question="Q3">
													 보험가입 후 실습생이 추가로 발생하는 경우, 추가로 보험에 가입해야 보상받을 수 있나요?
												</button>
											</h2>
											<div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p>보험가입시 대학교는 '학과별 인원수 현황'을 제출합니다.</p>
													<p><strong>추가로 실습을 나가게 된 학생이 기 제출한 학과에 소속된 학생이라면 보상받는데 문제가 없습니다.</strong></p>
													<p>즉, 기 제출한 학과에 소속된 학생이 3명 이내로 추가 발생한다 하더라도 추가로 보험에 가입하지 않아도 보상받을 수 있습니다.</p>
													<p class="text-primary"><strong>단, 새로운 학과의 학생이라면 반드시 추가로 보험에 가입해야 합니다.</strong></p>
												</div>
											</div>
										</div>

										<!-- Q4 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4" data-question="Q4">
													보험기간을 어떻게 설정해야 하는지 설명해주세요.
												</button>
											</h2>
											<div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p>실습기간(보험기간)은 <strong>가장 빨리 현장실습을 나가는 학생의 시작일과 가장 늦게 현장실습이 끝나는 학생의 종료일을 보험기간으로 잡으시면 됩니다.</strong></p>
													<p>참고로, 위의 보험기간은 보험료에 영향을 미치지 않습니다. 보험료는 실습기간별 참여인원을 기초로 합니다. (예, 4주 20명, 8주 30명…)</p>
													<p>실습기간은 실제로 학생이 실습을 참여한 기간을 주수로 계산합니다.</p>
													<div class="highlight">
														<p><strong>예시)</strong> 총 실습인원이 100명이고, 50명 씩 파트가 나뉘어져 실습이 이루어진다는 전제</p>
														<ul>
															<li>A파트의 실습기간 : 2023.05.01 ~ 2023.07.31</li>
															<li>B파트의 실습기간 : 2023.06.01 ~ 2023.08.31</li>
														</ul>
														<p class="text-primary"><strong>현장실습 보험 가입 시 보험기간 설정은 2023.05.01 ~ 2023.08.31 로 해주시면 됩니다.</strong></p>
													</div>
												</div>
											</div>
										</div>

										<!-- Q5 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5" data-question="Q5">
													혹시 현장실습보험에 가입할 수 없는 학과가 있습니까?
												</button>
											</h2>
											<div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p><strong>아래의 학과는 현장실습보험에 가입이 제한됩니다.</strong></p>
													<ul>
														<li>의사, 한의사, 약사, 치과의사, 한약사</li>
														<li>철도 및 항공종사관련 : 조종사, 기관사, 항공사, 정비사</li>
														<li>해양수관련 : 해기사(항해사, 기관사, 통신사, 운항사)</li>
														<li>초·중·고 및 특수학교 교사</li>
													</ul>
													<p class="text-primary"><strong>나머지 학과는 모두 보험 가입이 가능합니다.</strong></p>
												</div>
											</div>
										</div>

										<!-- Q6 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq6" data-question="Q6">
													개인적으로 가입한 실비보험(실손보험)이 있어도 현장실습보험 치료비에서 별도로 보상받을 수 있습니까?
												</button>
											</h2>
											<div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p><strong>실습중 상해사고로 치료비가 발생했을 경우 본인부담 치료비에 대해서 개인이 가입한 실손보험과는 별도로 이 보험에서 보장하는 치료비보장을 별도(추가)로 받을 수 있습니다.</strong></p>
													<p>단체상해보험이나 공제상품처럼 비례보상 하지 않고 별도로 계산하여 추가 보장하는 이유는 보험상품의 성격이 근본적으로 다르기 때문입니다.</p>
												</div>
											</div>
										</div>

										<!-- Q7 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq7" data-question="Q7">
													실습 중 사망시 실습기관과의 과실비율을 따져서 실습기관의 학생에 대한 배상책임액만큼을 보상한다고 알고 있습니다. 그렇다면 실습중 상해사망 보험을 별도로 가입할 수는 없나요?
												</button>
											</h2>
											<div id="faq7" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p><strong>가입이 가능합니다.</strong></p>
													<p>단, 이경우 학생이 이름과 주민번호 그리고 소속 학과정보를 저희 쪽에 제출해 주셔야 합니다.</p>
													<p>제출해주신 자료를 근거로 보험료를 산출하여 추가 가입할 수 있도록 안내드립니다.</p>
												</div>
											</div>
										</div>

										<!-- Q8 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq8" data-question="Q8">
													우리학교는 기존에 단체상해보험 또는 학생실습보험을 가입했습니다. 이런 경우에도 현장실습보험에 가입해야 하나요?
												</button>
											</h2>
											<div id="faq8" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p>대부분의 대학들이 위의 단체상해보험(공제포함), 학생실습보험에 가입했었고, 현재도 가입중인 대학들이 있습니다.</p>
													<p><strong>이 상품들이 "실습기관의 민사상 배상책임"을 보장하지 않고 있기 때문에 본 상품이 개발된 것입니다.</strong></p>
													<p>18.9.11 대학생현장실습생의 산재보험가입 의무화가 법으로 강제화 된 이유도 "실습기관의 민사상 배상책임"을 최소한이라도 법으로 강제하기 위함입니다.</p>
													<p>기존에 가입하던 단체상해보험, 실습보험의 사망보험금 등은 민사상 배상책임과는 전혀 무관하기 때문에 실습중 발생하는 사망, 후유장해 등으로 인한 배상책임을 전혀 담보하지 못하고 있습니다.</p>
												</div>
											</div>
										</div>

										<!-- Q9 -->
										<div class="accordion-item">
											<h2 class="accordion-header">
												<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq9" data-question="Q9">
													산재보험에서 실습중 사고에 대해서 보장해주는데 이 보험에 추가 가입해야 하는 이유는 무엇인가요?
												</button>
											</h2>
											<div id="faq9" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
												<div class="accordion-body">
													<p><strong>아래의 사유로 보험가입이 꼭 필요합니다.</strong></p>
													
													<div class="highlight">
														<p><strong>첫째,</strong> 산재보험에서 제외되는 간호학과, 유아교육과 등의 실습수업 등은 산재보험에서 보장받을 수 없으므로 이 보험에서 보상합니다.</p>
													</div>

													<div class="highlight">
														<p><strong>둘째,</strong> 산재보험은</p>
														<ul>
															<li>위자료(1억원 한도)를 지급하지 않습니다.</li>
															<li>휴업으로 인해 취업을 못할 경우 평균임의 70% 수준 보장.</li>
															<li>장해가 발생했을 때, 연금이나 일시금으로 지급 받을 수 있는데 장해급수에 따른 금액산정액이 정해져 있으므로 충분하다 할 수 없음.</li>
															<li>치료비에 대해서는 요양급여에서 지급되는데, 비급여 항목은 보상에서 제외.</li>
														</ul>
														<p><strong>위자료, 휴업급여의 차액, 장해연금의 차액 및 요양급여 중 비급여항목 등 산재보험에서 지급받지 못한 금액을 현장실습보험에서 보장받을 수 있습니다.</strong></p>
														<p class="text-primary">(단체상해보험 및 학생실습보험 보장은 위 산재보험에서 제외되는 차액 등을 보장하거나 및 대체할 수 없음)</p>
													</div>

													<div class="highlight">
														<p><strong>셋째,</strong> 산재사고 발생시 피해당사자(학생) 및 가족 그리고 사망시 유족 등은 산재보상 외에 추가 피해보상을 요구합니다.</p>
														<p>추가 피해보상이 원만하게 이루어지지 않을경우 법적 소송(근거:민사상 배상책임)을 청구</p>
														<ul>
															<li>대부분의 실습기관들은 산재보험 외에 이러한 추가 피해보상 및 법적 소송에 대한 대비책을 가지고 있지 못한 경우가 대부분이고, 이런 피해자 측의 요구에 해당 대학교도 사고책임의 당사자로 연결될 수 밖에 없습니다.</li>
															<li>이 경우 현장실습보험은 실습기관이 책임져야하는 산재보험 초과 손해에 대해 보상해주고, 합의를 하면서 사건을 종결시킵니다.</li>
															<li>만약 합의에 이르지 못할 경우 법적 소송에 따른 변호사 선임비용 등을 이 보험에서 보상하며, 판사가 결정한 판결금액을 보험금으로 지급하면서 사건을 종결합니다.</li>
														</ul>
													</div>

													<p class="text-primary"><strong>※ 대기업, 건설회사, 선박회사 등은 근로자의 산재사고시 추가 피해보상에 대비하기 위해 근재보험을 반드시 추가로 가입하고 있습니다. 근재보험의보장내용이 이 보험의 배상책임과 동일함.</strong></p>
												</div>
											</div>
										</div>

									</div>
								</div>
							</div>
						</div>
                    `
                },
                compensation: {
                    title: '💰 보상 안내',
                    content: `
                        <div style="line-height: 1.8; color: #4a5568;">
                            <h3 style="color: #2d3748; margin-bottom: 1rem;">💊 의료비 보상</h3>
                            <ul style="margin-bottom: 1.5rem; padding-left: 1.5rem;">
                                <li>실습 중 발생한 상해에 대한 치료비</li>
                                <li>응급처치 및 입원비</li>
                                <li>재활치료비</li>
                            </ul>
                            
                            <h3 style="color: #2d3748; margin-bottom: 1rem;">⚖️ 배상책임 보상</h3>
                            <p style="margin-bottom: 1.5rem;">실습 중 타인에게 피해를 입힌 경우의 배상책임을 보장합니다.</p>
                            
                            <div style="background: #fef2f2; padding: 1rem; border-radius: 10px; border-left: 4px solid #ef4444;">
                                <p><strong>📞 사고 발생 시 즉시 연락:</strong> 1588-0000</p>
                            </div>
                        </div>
                    `
                },
                notice: {
                    title: '📢 공지사항',
                    content: `
                        <div class="container">
        
        
        <!-- Q1: 보험청약서 예시 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-file-contract me-2"></i> 보험청약서 (예시)</h3>
                    <div class="alert alert-info mb-4">
                        <p class="mb-2">담당 선생님들이 궁금해 하시네요. 보험청약서 예시자료를 첨부합니다.</p>
                        <p class="mb-0">기존에 단체상해보험 등으로 가입했던 학교들의 현장실습 담당 선생님들께서 특히, 청약서 등을 확인하고 싶어하시는 것 같습니다. 참고하여 주시기 바랍니다.</p>
                    </div>
                    <div class="text-center">
                        <a href="/api/file/보험청약서_예시.pdf" class="btn btn-primary" target="_blank">
                            <i class="fas fa-download me-2"></i>보험청약서 예시 다운로드
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q2: 보험조건 특별약관 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-exclamation-triangle me-2"></i>보험조건(Terms & Condition) - 보장하지 않는 조항</h3>
                    <div class="alert alert-warning mb-4">
                        <p class="mb-2">특별약관(보상하지 않는 조항) 세부 조건을 아래와 같이 정리하였습니다.</p>
                        <p class="mb-0">약관 내용은 번역본과 영문원본을 첨부합니다.</p>
                    </div>
                    
                    <div class="bg-light p-4 rounded mb-4">
                        <h5 class="mb-3"><strong>[ Terms & Conditions ]</strong></h5>
                        <ul class="list-unstyled">
                            <li class="mb-2">◼ Commercial General Liability Policy Form(I) –Occurrence Basis<br>
                                <small class="text-muted">영문영업배상책임보험약관적용_손해사고기준</small></li>
                            <li class="mb-2">◼ Products/Completed Operation Hazard Exclusion Clause<br>
                                <small class="text-muted">생산물/완성작업위험 부보장 특약</small></li>
                            <li class="mb-2">◼ Cross Liability Clause<br>
                                <small class="text-muted">교차배상책임담보 특약</small></li>
                            <li class="mb-2">◼ Punitive Damage Exclusion Clause<br>
                                <small class="text-muted">징벌적 손해배상책임 부보장 특약</small></li>
                            <li class="mb-2">◼ Nuclear Energy Liability Exclusion Clause<br>
                                <small class="text-muted">원자력배상책임 부보장 특약</small></li>
                            <li class="mb-2">◼ Compulsory Gas Accident Liability Exclusion Clause<br>
                                <small class="text-muted">(의무)가스사고배상 부보장 특약</small></li>
                            <li class="mb-2">◼ Premium and Claim Payment Clause<br>
                                <small class="text-muted">보험료 & 보험금 청구 지불조건</small></li>
                            <li class="mb-2">◼ Deductible Liability Insurance Clause<br>
                                <small class="text-muted">기초공제 특약</small></li>
                            <li class="mb-2">◼ Property Entrusted Exclusion Clause<br>
                                <small class="text-muted">수탁물건 부보장 특약</small></li>
                            <li class="mb-2">◼ Millennium Exclusion Clause<br>
                                <small class="text-muted">서기 2000년 부보장 특약</small></li>
                            <li class="mb-2">◼ All costs & Expenses are included within the L.O.L.<br>
                                <small class="text-muted">제비용 보상한도액 내 담보조항</small></li>
                            <li class="mb-2">◼ Terrorism Exclusion Endorsement(NMA2952)<br>
                                <small class="text-muted">테러위험 부보장 특약</small></li>
                            <li class="mb-2">◼ EMF & Asbestos & Silica Risk Excluded.<br>
                                <small class="text-muted">전자기기.전자장/설면/실리카 위험 부보장 특약</small></li>
                            <li class="mb-2">◼ Exclusion of dust and noise<br>
                                <small class="text-muted">먼지 및 소음관련 부보장 특약</small></li>
                            <li class="mb-2">◼ Limitation of Coverage to Designated Premises or Project Clause<br>
                                <small class="text-muted">특정구내 또는 사업만의 보장 특약</small></li>
                            <li class="mb-0">◼ Policy Territory and Jurisdiction : Korea only<br>
                                <small class="text-muted">담보지역 및 재판관할권 : 대한민국</small></li>
                        </ul>
                    </div>
                    
                    <div class="text-center">
                        <a href="/api/file/보험조건_특별약관_번역본.pdf" class="btn btn-outline-primary me-2" target="_blank">
                            <i class="fas fa-download me-2"></i>번역본 다운로드
                        </a>
                        <a href="/api/file/보험조건_특별약관_영문원본.pdf" class="btn btn-outline-primary" target="_blank">
                            <i class="fas fa-download me-2"></i>영문원본 다운로드
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q3: 상품 약관 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-book me-2"></i> 상품 약관 (영문약관 및 번역약관) - 파일 다운로드 가능</h3>
                    <div class="alert alert-info mb-4">
                        <p class="mb-2">본 상품은 <strong>"영문영업배상책임보험"</strong>을 채택하여 사용하고 있습니다.</p>
                        <ul class="mb-2">
                            <li>영문영업배상책임보험은 포괄주의 약관이 특징입니다.</li>
                            <li>즉, 보통약관에서 모든 위험을 포괄하여 보장하며, 특별약관에서 보장에서 제외되는 항목을 나열하고 있습니다.</li>
                        </ul>
                        <p class="mb-0">보통약관 영문 원문과 번역본을 첨부하오니 참고하여 주시기 바랍니다.</p>
                    </div>
                    <div class="text-center">
                        <a href="/api/file/현장실습보험-약관-(CGL).pdf" class="btn btn-primary" target="_blank">
                            <i class="fas fa-download me-2"></i>현장실습보험 약관 다운로드
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q4: 간호학과 가입 안내 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-user-nurse me-2"></i>간호학과 현장실습보험 가입 가능</h3>
                    <div class="alert alert-success mb-4">
                        <h5 class="alert-heading">안녕하십니까</h5>
                        <p class="mb-2">기존에 현장실습보험 가입에서 제외되었던 <strong>"간호학과"</strong>에 대해서</p>
                        <p class="mb-2"><strong class="text-success">2016년 12월 1일부터 가입이 가능</strong>하게 되었습니다.</p>
                        <p class="mb-0">참고해 주시기 바랍니다. 감사합니다.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q5: 보험금 청구서 양식 및 작성 예시문 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-file-alt me-2"></i>보험금 청구서 양식 및 작성 예시문</h3>
                    
                    <div class="alert alert-info mb-4">
                        <h5 class="alert-heading"><i class="fas fa-info-circle me-2"></i>필요서류</h5>
                        <ol class="mb-2">
                            <li class="mb-2"><strong>보험금 청구서(+필수 동의서) 및 문답서</strong> (첨부파일 참고)
                                <br><small class="text-warning">※ 보험금 청구 기간은 최대 1년까지 가능합니다.</small>
                            </li>
                            <li class="mb-2"><strong>신분증 및 통장사본</strong></li>
                            <li class="mb-2"><strong>진단서 또는 초진차트</strong></li>
                            <li class="mb-2"><strong>병원치료비 영수증(계산서)</strong>_치료비세부내역서, 약제비 영수증</li>
                            <li class="mb-2"><strong>실습기관의 현장실습 출석부 사본 또는 실습일지</strong></li>
                            <li class="mb-2"><strong>학생 학적을 확인할 수 있는 학교 전산 캡처본</strong></li>
                            <li class="mb-0"><strong>(고등학생 현장 실습 사고 접수 경우만 해당)</strong>
                                <br>보험금 청구서 밑의 법정대리인의 서명, 가족관계증명서, 보호자 신분증 및 통장사본
                            </li>
                        </ol>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="bg-light p-3 rounded">
                                <h6 class="text-primary mb-2"><i class="fas fa-envelope me-2"></i>보내주실 곳</h6>
                                <p class="mb-0"><strong>이메일:</strong> lincinsu@simg.kr</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="bg-light p-3 rounded">
                                <h6 class="text-primary mb-2"><i class="fas fa-clock me-2"></i>서류 접수 후 처리되는 시간</h6>
                                <p class="mb-2">서류에 이상이 없을 경우 <strong class="text-success">3~5일 이내</strong>에 본인 통장으로 계산된 보험금이 지급됩니다.</p>
                                <p class="mb-0">청구서 상의 연락처로 문자를 보내드립니다.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <a href="/api/file/보험금-청구서,동의서,문답서.pdf" class="btn btn-primary" target="_blank">
                            <i class="fas fa-download me-2"></i>보험금 청구서 양식 다운로드
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q6: 질문서 양식 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-question-circle me-2"></i>질문서 양식 - 현장실습보험</h3>
                    <div class="alert alert-info mb-4">
                        <p class="mb-2">홈페이지 카테고리 중에서 <strong>"견적의뢰"</strong> 란에서 직접 질문서 작성을 해 주셔도 됩니다.</p>
                        <p class="mb-0">혹시라도 오류가 발생하거나, 문서로 필요하신 경우에는 첨부하는 질문서 양식을 출력하여 사용해 주시기 바랍니다.</p>
                    </div>
                    <div class="bg-light p-3 rounded mb-4">
                        <h6 class="text-primary mb-2"><i class="fas fa-arrow-right me-2"></i>처리 절차</h6>
                        <p class="mb-0"><strong>질문서 출력 → 작성 → 이메일 발송</strong></p>
                        <p class="mb-0"><strong>이메일:</strong> sy@fstudent.kr</p>
                        <p class="mb-0"><strong>담당자:</strong> 전선양 팀장</p>
                    </div>
                    <div class="text-center">
                        <a href="/api/file/질문서양식_현장실습보험.pdf" class="btn btn-primary" target="_blank">
                            <i class="fas fa-download me-2"></i>질문서 양식 다운로드
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q7: 보험가입 제외대상 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-ban me-2"></i>보험가입 제외대상 학과</h3>
                    <div class="alert alert-warning mb-4">
                        <h5 class="alert-heading">아래의 경우는 현장실습의 범위에서 제외합니다.</h5>
                        <p class="mb-2">학과(전공) 특성상 (전문)자격취득요건 충족을 위해 아래의 현장실습을 나가는 경우 제외합니다.</p>
                    </div>
                    
                    <div class="bg-light p-4 rounded mb-4">
                        <h6 class="text-danger mb-3"><strong>제외 대상</strong></h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><strong>가.</strong> 의사, 한의사, 약사, 치과의사, 한약사</li>
                            <li class="mb-2"><strong>나.</strong> 철도 및 항공종사관련 : 조종사, 기관사, 항공사, 정비사</li>
                            <li class="mb-2"><strong>다.</strong> 해양수관련 : 해기사(항해사, 기관사, 통신사, 운항사)</li>
                            <li class="mb-0"><strong>라.</strong> 초·중·고 및 특수학교 교사</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-secondary">
                        <h6 class="mb-2"><strong>대안 안내</strong></h6>
                        <p class="mb-2">위와 같이 제외되는 현장실습생들의 경우에는 어쩔 수 없이 <strong>"단체상해보험"</strong>으로 안내가 가능합니다.</p>
                        <p class="mb-0">따라서, 제외되는 현장실습생들의 경우에는 <strong>"이름/주민번호/학과/기간"</strong>의 개인정보를 정리해서 문의해 주시기 바랍니다.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q8: 보험기간 설정 안내 -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="feature-card">
                    <h3 class="text-primary mb-4"><i class="fas fa-calendar-alt me-2"></i>보험기간 설정할 때 참고하세요</h3>
                    <div class="alert alert-info mb-4">
                        <p class="mb-2">현장실습 관련하여 보험계약은 특별한 경우를 제외하고는 아래와 같이 <strong>연간 4회</strong> 이루어집니다.</p>
                        <p class="mb-0"><strong>1학기, 하계 계절학기, 2학기, 동계 계절학기</strong></p>
                    </div>
                    
                    <div class="bg-light p-4 rounded mb-4">
                        <h6 class="text-primary mb-3"><strong>보험기간 설정 방법</strong></h6>
                        <p class="mb-2">보험견적을 의뢰할 때(질문서 작성시) 실습기간(보험기간)을 작성할때:</p>
                        <ul class="mb-0">
                            <li><strong>가장 빨리</strong> 현장실습을 나가는 학생의 <strong>시작일</strong></li>
                            <li><strong>가장 늦게</strong> 현장실습이 끝나는 학생의 <strong>종료일</strong></li>
                        </ul>
                        <p class="mt-2 mb-0">을 보험기간으로 설정하시면 됩니다.</p>
                    </div>
                    
                    <div class="alert alert-success">
                        <h6 class="alert-heading"><i class="fas fa-lightbulb me-2"></i>예시 - 하계 여름학기 실습기간(보험기간) 설정</h6>
                        <ul class="mb-2">
                            <li>가장 빨리 현장실습 시작하는 학생의 시작일 : <strong>2016년 06월 25일</strong></li>
                            <li>가장 늦게 현장실습 종료되는 학생의 종료일 : <strong>2016년 09월 02일</strong></li>
                        </ul>
                        <p class="mb-2"><strong>⇒ 하계 여름학기 보험기간 (2016.06.25) ~ (2016.09.02)</strong></p>
                        <p class="mb-0"><small class="text-muted">※ 참고) 보험기간은 위와 같이 설정하고 보험료는 실습기간별 참여인원을 기준으로 계산합니다.</small></p>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
                    `
                }
            };
            
            return pages[pageId] || { title: '페이지를 찾을 수 없습니다', content: '<p>요청하신 페이지를 찾을 수 없습니다.</p>' };
        }

        // === 보험가입 유형 테이블 업데이트 함수 ===
        function updateInsuranceTable(directory) {
            const planALiability = document.getElementById('plan-a-liability');
            const planBLiability = document.getElementById('plan-b-liability');
            const planAWorkers = document.getElementById('plan-a-workers');
            const planBWorkers = document.getElementById('plan-b-workers');
            
            if (!planALiability || !planBLiability || !planAWorkers || !planBWorkers) {
                console.log('보험가입 유형 테이블 업데이트: 필요한 DOM 요소를 찾을 수 없습니다.');
                return;
            }

            const isUniversity = directory === '1';
            
            // 대인 및 대물 배상책임
            planALiability.textContent = `사고당 ${isUniversity ? '2' : '1'}억원`;
            planBLiability.textContent = `사고당 ${isUniversity ? '3' : '2'}억원`;
            
            // 산재보험 초과 배상책임
            planAWorkers.textContent = `사고당 ${isUniversity ? '2' : '1'}억원`;
            planBWorkers.textContent = `사고당 ${isUniversity ? '3' : '2'}억원`;
            
            // 학교 유형에 따라 타이틀 수정
            const contractorSubtitle = document.getElementById('contractor-subtitle');
            if (contractorSubtitle) {
                contractorSubtitle.textContent = isUniversity ? 
                    '(대학교 또는 산학협력단)' : '(고등학교)';
            }
        }

        // === 메뉴 호버 효과 추가 ===
        function addMenuHoverEffects() {
            const menuCards = document.querySelectorAll('.menu-card');
            
            menuCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-8px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
        }

        // === 스크롤 효과 추가 ===
        function addScrollEffects() {
            let lastScroll = 0;
            const header = document.querySelector('.header');
            
            window.addEventListener('scroll', () => {
                const currentScroll = window.pageYOffset;
                
                if (currentScroll <= 0) {
                    header.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)';
                    header.style.transform = 'translateY(0)';
                    return;
                }
                
                // 헤더는 항상 보이도록 설정
                header.style.transform = 'translateY(0)';
                
                lastScroll = currentScroll;
            });
        }

        // === 로그아웃 처리 ===
        // === 로그아웃 시 세션 정리 개선 ===
function handleLogout() {
    if (confirm('정말 로그아웃 하시겠습니까?')) {
        // 자동 로그아웃 관리자 정리
        if (typeof AutoLogout !== 'undefined') {
            AutoLogout.cleanup();
        }
        
        // 모든 세션 스토리지 정리
        sessionStorage.clear();
        
        // 서버에 로그아웃 알림 (옵션)
        notifyServerLogout();
        
        showNotification('로그아웃 되었습니다.', 'success');
        
        setTimeout(() => {
            window.location.href = 'index.html';
        }, 1000);
    }
}

// === 서버 로그아웃 알림 ===
async function notifyServerLogout() {
    try {
        const cNum = sessionStorage.getItem('cNum');
        const mem_id = sessionStorage.getItem('mem_id');
        
        if (cNum && mem_id) {
            await fetch('https://silbo.kr/2025/api/teacher/logout.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    cNum: cNum,
                    mem_id: mem_id
                })
            });
        }
    } catch (error) {
        console.error('서버 로그아웃 알림 오류:', error);
    }
}

        // === 키보드 네비게이션 ===
        document.addEventListener('keydown', function(e) {
            // ESC 키로 메인 메뉴로 돌아가기
            if (e.key === 'Escape' && currentPage !== 'main') {
                showMainMenu();
            }
            
            // 숫자 키로 메뉴 선택 (1-7)
            if (currentPage === 'main' && e.key >= '1' && e.key <= '7') {
                const menuItems = ['guide', 'application', 'questions', 'process', 'faq', 'compensation', 'notice'];
                const index = parseInt(e.key) - 1;
                if (menuItems[index]) {
                    goToPage(menuItems[index]);
                }
            }
        });

        // === 테마 토글 기능 (추가 기능) ===
        function toggleTheme() {
            const body = document.body;
            body.classList.toggle('dark-theme');
            
            // 로컬 스토리지에 테마 저장 (실제 환경에서만 작동)
            try {
                const isDark = body.classList.contains('dark-theme');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            } catch (e) {
                console.log('로컬 스토리지를 사용할 수 없습니다.');
            }
        }

        // === 알림 시스템 ===
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                z-index: 10000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                max-width: 300px;
                word-wrap: break-word;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // 애니메이션으로 표시
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // 3초 후 자동 제거
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // === 성능 최적화를 위한 디바운스 함수 ===
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // === 접근성 개선 ===
        function improveAccessibility() {
            // 메뉴 카드에 키보드 네비게이션 추가
            const menuCards = document.querySelectorAll('.menu-card');
            menuCards.forEach((card, index) => {
                card.setAttribute('tabindex', '0');
                card.setAttribute('role', 'button');
                card.setAttribute('aria-label', card.querySelector('.menu-title').textContent);
                
                card.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        card.click();
                    }
                });
            });
            
            // 포커스 표시 개선
            const style = document.createElement('style');
            style.textContent = `
                .menu-card:focus {
                    outline: 3px solid #667eea;
                    outline-offset: 2px;
                }
                
                button:focus {
                    outline: 2px solid #667eea;
                    outline-offset: 2px;
                }
            `;
            document.head.appendChild(style);
        }

        // === 다크 테마 스타일 ===
        function addDarkThemeStyles() {
            const darkThemeStyles = `
                .dark-theme {
                    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                    color: #e2e8f0;
                }
                
                .dark-theme .header {
                    background: rgba(26, 26, 46, 0.95);
                }
                
                .dark-theme .menu-card,
                .dark-theme .welcome-section,
                .dark-theme .content-area {
                    background: rgba(45, 55, 72, 0.9);
                    color: #e2e8f0;
                }
                
                .dark-theme .menu-title {
                    color: #f7fafc;
                }
                
                .dark-theme .menu-description {
                    color: #cbd5e0;
                }
            `;
            
            const style = document.createElement('style');
            style.textContent = darkThemeStyles;
            document.head.appendChild(style);
        }

        // === 확장된 초기화 ===
        document.addEventListener('DOMContentLoaded', function() {
            // 먼저 세션 체크
            if (!validateSession()) {
                return; // 세션이 없으면 여기서 중단 (자동으로 로그인 페이지로 이동)
            }
            
            initializeSystem();
            loadSchoolInfo();
            
            // 추가 기능들 초기화
            setTimeout(() => {
                improveAccessibility();
                addDarkThemeStyles();
                
                // 로그인 성공 후 환영 메시지
                const isNewLogin = sessionStorage.getItem('isNewLogin');
                if (isNewLogin === 'true') {
                    showNotification('로그인되었습니다! 시스템을 이용해보세요.', 'success');
                    sessionStorage.removeItem('isNewLogin'); // 한 번만 표시
                } else {
                    showNotification('시스템이 성공적으로 로드되었습니다!', 'info');
                }
            }, 100);
        });

        // === 유틸리티 함수들 ===
        
        // 현재 시간 표시
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR');
            console.log('현재 시간:', timeString);
        }
        
        // 브라우저 정보 확인
        function getBrowserInfo() {
            const userAgent = navigator.userAgent;
            console.log('브라우저 정보:', userAgent);
            return userAgent;
        }
        
        // 화면 크기에 따른 반응형 처리
        function handleResize() {
            const width = window.innerWidth;
            const menuGrid = document.getElementById('menuGrid');
            
            if (width < 768) {
                menuGrid.style.gridTemplateColumns = '1fr';
            } else if (width < 1200) {
                menuGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
            } else {
                menuGrid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(350px, 1fr))';
            }
        }
        
        // 리사이즈 이벤트 리스너 (디바운스 적용)
        window.addEventListener('resize', debounce(handleResize, 250));
        
        // === 개발자 도구 (개발 시에만 사용) ===
        function devTools() {
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('🛠️ 개발 모드 활성화');
                console.log('현재 페이지:', currentPage);
                console.log('학교 데이터:', schoolData);
                
                // 개발자용 단축키
                document.addEventListener('keydown', function(e) {
                    // Ctrl + Shift + D로 다크 테마 토글
                    if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                        toggleTheme();
                        showNotification('테마가 변경되었습니다.', 'info');
                    }
                    
                    // Ctrl + Shift + R로 페이지 새로고침
                    if (e.ctrlKey && e.shiftKey && e.key === 'R') {
                        location.reload();
                    }
                });
            }
        }
        
        // 개발자 도구 실행
        devTools();
        
        console.log('🎉 현장실습보험 관리 시스템이 완전히 로드되었습니다!');

        // === 세션 검증 함수 ===
        // === 개선된 세션 검증 함수 ===
// 개선된 세션 검증 함수
function validateSession() {
    try {
        console.log('세션 검증 시작...');
        
        // sessionStorage 접근 가능 여부 확인
        if (typeof Storage === "undefined") {
            console.error('브라우저가 sessionStorage를 지원하지 않습니다.');
            redirectToLogin('브라우저가 세션 저장을 지원하지 않습니다.');
            return false;
        }
        
        // 전체 세션 정보 로그
        console.log('현재 sessionStorage 내용:');
        for (let i = 0; i < sessionStorage.length; i++) {
            const key = sessionStorage.key(i);
            const value = sessionStorage.getItem(key);
            console.log(`  ${key}: ${value}`);
        }
        
        const cNum = sessionStorage.getItem('cNum');
        const schoolName = sessionStorage.getItem('schoolName');
        const mem_id = sessionStorage.getItem('mem_id');
        const sessionValid = sessionStorage.getItem('sessionValid');
        
        console.log('세션 검증 데이터:', {
            cNum,
            schoolName,
            mem_id,
            sessionValid
        });
        
        // 필수 세션 정보 확인
        if (!cNum || cNum === 'null' || cNum === 'undefined') {
            console.log('세션 검증 실패: cNum 누락 또는 잘못된 값');
            redirectToLogin('로그인 정보가 없습니다. (cNum)');
            return false;
        }
        
        if (!schoolName || schoolName === 'null' || schoolName === 'undefined') {
            console.log('세션 검증 실패: schoolName 누락 또는 잘못된 값');
            redirectToLogin('로그인 정보가 없습니다. (schoolName)');
            return false;
        }
        
        if (!mem_id || mem_id === 'null' || mem_id === 'undefined') {
            console.log('세션 검증 실패: mem_id 누락 또는 잘못된 값');
            redirectToLogin('로그인 정보가 없습니다. (mem_id)');
            return false;
        }
        
        // 세션 유효성 확인
        if (sessionValid !== 'true') {
            console.log('세션 검증 실패: 세션이 유효하지 않음');
            redirectToLogin('세션이 유효하지 않습니다.');
            return false;
        }
        
        console.log('세션 검증 성공');
        return true;
        
    } catch (error) {
        console.error('세션 검증 중 오류:', error);
        redirectToLogin('세션 검증 중 오류가 발생했습니다.');
        return false;
    }
}
// === 로그인 페이지로 리다이렉트 함수 ===
// 로그인 페이지로 리다이렉트 (지연 시간 추가)
function redirectToLogin(message) {
    console.log('로그인 페이지로 리다이렉트:', message);
    
    showNotification(message, 'error');
    
    // 세션 정리 (문제가 있는 세션 제거)
    try {
        sessionStorage.removeItem('sessionValid');
    } catch (e) {
        console.error('세션 정리 중 오류:', e);
    }
    
    setTimeout(() => {
        window.location.href = 'index.html';
    }, 2000); // 2초로 연장하여 사용자가 메시지를 읽을 수 있도록
}


// 개선된 초기화 함수
// main.html의 DOMContentLoaded 이벤트 완전 교체
document.addEventListener('DOMContentLoaded', function() {
    console.log('main.html 페이지 로드 시작');
    
    // 1. URL 파라미터 확인 (임시 해결책)
    const urlParamsHandled = handleUrlParams();
    
    // 2. 전역 변수 확인 (또 다른 임시 해결책)
    if (window.tempSessionData && !sessionStorage.getItem('cNum')) {
        console.log('전역 변수에서 세션 데이터 복구 시도');
        try {
            const data = window.tempSessionData;
            sessionStorage.setItem('cNum', String(data.cNum));
            sessionStorage.setItem('schoolName', String(data.schoolName));
            sessionStorage.setItem('mem_id', String(data.mem_id || 'admin'));
            sessionStorage.setItem('damdanga', String(data.damdanga || '관리자'));
            sessionStorage.setItem('sessionValid', 'true');
            console.log('전역 변수에서 세션 복구 완료');
        } catch (error) {
            console.error('전역 변수 세션 복구 실패:', error);
        }
    }
    
    // 3. 세션 검증 (지연 후 재시도)
    let retryCount = 0;
    const maxRetries = 5;
    
    function tryInitialize() {
        retryCount++;
        console.log(`초기화 시도 ${retryCount}/${maxRetries}`);
        
        // sessionStorage 접근 가능 확인
        try {
            const testKey = 'test_' + Date.now();
            sessionStorage.setItem(testKey, 'test');
            sessionStorage.removeItem(testKey);
            console.log('sessionStorage 접근 가능');
        } catch (error) {
            console.error('sessionStorage 접근 불가:', error);
            
            if (retryCount < maxRetries) {
                setTimeout(tryInitialize, 1000 * retryCount);
                return;
            } else {
                alert('브라우저가 세션 저장을 지원하지 않습니다.\n시크릿 모드가 아닌 일반 모드로 다시 시도해주세요.');
                window.location.href = 'index.html';
                return;
            }
        }
        
        // 세션 정보 확인
        const cNum = sessionStorage.getItem('cNum');
        const schoolName = sessionStorage.getItem('schoolName');
        const mem_id = sessionStorage.getItem('mem_id');
        
        console.log('세션 확인:', { 
            cNum: cNum, 
            schoolName: schoolName, 
            mem_id: mem_id,
            cNumType: typeof cNum,
            schoolNameType: typeof schoolName,
            memIdType: typeof mem_id
        });
        
        // 세션 유효성 검사
        if (!cNum || !schoolName || !mem_id || 
            cNum === 'null' || schoolName === 'null' || mem_id === 'null' ||
            cNum.trim() === '' || schoolName.trim() === '' || mem_id.trim() === '') {
            
            console.log(`세션 정보 불완전, 재시도: ${retryCount}/${maxRetries}`);
            
            if (retryCount < maxRetries) {
                setTimeout(tryInitialize, 1000 * retryCount);
                return;
            } else {
                console.error('세션 정보를 찾을 수 없습니다.');
                
                // 디버깅 정보 표시
                console.log('전체 sessionStorage 내용:');
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    const value = sessionStorage.getItem(key);
                    console.log(`  ${key}: "${value}" (${typeof value})`);
                }
                
                showNotification('로그인 정보가 없습니다. 다시 로그인해주세요.', 'error');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 3000);
                return;
            }
        }
        
        console.log('✅ 세션 확인 완료, 시스템 초기화 시작');
        
        try {
            // 자동 로그아웃 관리자 초기화
            initAutoLogout();
            
            // 기존 초기화 함수들
            initializeSystem();
            loadSchoolInfo();
            
            console.log('✅ 시스템 초기화 완료');
            
        } catch (error) {
            console.error('시스템 초기화 중 오류:', error);
            showNotification('시스템 초기화 중 오류가 발생했습니다.', 'error');
        }
    }
    
    // 첫 번째 시도는 즉시 실행
    tryInitialize();
});
// URL 파라미터 처리 함수 (main.html에 추가)
function handleUrlParams() {
    const urlParams = new URLSearchParams(window.location.search);
    const isTemp = urlParams.get('temp');
    
    if (isTemp === 'true') {
        console.log('URL 파라미터로 세션 데이터 복구 시도');
        
        const cNum = urlParams.get('cNum');
        const schoolName = urlParams.get('schoolName');
        const mem_id = urlParams.get('mem_id');
        const damdanga = urlParams.get('damdanga');
        
        if (cNum && schoolName && mem_id) {
            try {
                sessionStorage.clear(); // 기존 데이터 정리
                
                sessionStorage.setItem('cNum', cNum);
                sessionStorage.setItem('schoolName', schoolName);
                sessionStorage.setItem('mem_id', mem_id);
                sessionStorage.setItem('damdanga', damdanga || '관리자');
                sessionStorage.setItem('damdangat', '');
                sessionStorage.setItem('directory', '1');
                sessionStorage.setItem('sessionValid', 'true');
                sessionStorage.setItem('loginTime', Date.now().toString());
                sessionStorage.setItem('isNewLogin', 'true');
                
                console.log('✅ URL 파라미터로 세션 복구 완료');
                
                // URL에서 파라미터 제거
                window.history.replaceState({}, document.title, window.location.pathname);
                
                return true;
            } catch (error) {
                console.error('URL 파라미터 세션 복구 실패:', error);
                return false;
            }
        }
    }
    
    return false;
}// 디버깅용 함수들 (개발 중에만 사용)
function debugSessionStorage() {
    console.log('=== SessionStorage 디버깅 ===');
    console.log('지원 여부:', typeof(Storage) !== "undefined");
    console.log('항목 수:', sessionStorage.length);
    
    for (let i = 0; i < sessionStorage.length; i++) {
        const key = sessionStorage.key(i);
        const value = sessionStorage.getItem(key);
        console.log(`${key}: "${value}" (길이: ${value ? value.length : 0})`);
    }
    console.log('============================');
}

// 수동 세션 설정 (긴급 상황용)
function emergencySessionSet() {
    const cNum = prompt('cNum을 입력하세요:');
    const schoolName = prompt('학교명을 입력하세요:');
    const mem_id = prompt('mem_id를 입력하세요:');
    
    if (cNum && schoolName && mem_id) {
        try {
            sessionStorage.setItem('cNum', cNum);
            sessionStorage.setItem('schoolName', schoolName);
            sessionStorage.setItem('mem_id', mem_id);
            sessionStorage.setItem('sessionValid', 'true');
            
            alert('세션이 수동으로 설정되었습니다.');
            location.reload();
        } catch (error) {
            alert('세션 설정 실패: ' + error.message);
        }
    }
}

// 전역 함수로 등록 (콘솔에서 사용 가능)
window.debugSessionStorage = debugSessionStorage;
window.emergencySessionSet = emergencySessionSet;
// ========================================
// 3. 디버깅을 위한 추가 함수들
// ========================================

// 세션 상태 확인 함수
function checkSessionStatus() {
    console.log('=== 세션 상태 확인 ===');
    console.log('sessionStorage 지원:', typeof Storage !== "undefined");
    console.log('sessionStorage 항목 수:', sessionStorage.length);
    
    const sessionData = {};
    for (let i = 0; i < sessionStorage.length; i++) {
        const key = sessionStorage.key(i);
        sessionData[key] = sessionStorage.getItem(key);
    }
    
    console.log('세션 데이터:', sessionData);
    console.log('======================');
    
    return sessionData;
}

// 수동 세션 복구 함수 (개발용)
function manualSessionRestore(cNum, schoolName, mem_id) {
    console.log('수동 세션 복구 시도...');
    
    const loginTime = Date.now();
    const sessionData = {
        cNum: cNum,
        schoolName: schoolName,
        mem_id: mem_id,
        damdanga: '관리자',
        damdangat: '',
        directory: '1',
        loginTime: loginTime.toString(),
        lastActivity: loginTime.toString(),
        sessionValid: 'true'
    };
    
    for (const [key, value] of Object.entries(sessionData)) {
        sessionStorage.setItem(key, value);
    }
    
    console.log('수동 세션 복구 완료:', sessionData);
    return verifySessionData();
}

// 페이지 언로드 시 세션 상태 로그
window.addEventListener('beforeunload', function() {
    console.log('페이지 언로드 - 현재 세션 상태:');
    checkSessionStatus();
});
        // === 환영 메시지 업데이트 ===
        function updateWelcomeMessage(schoolInfo) {
            const welcomeTitle = document.querySelector('.welcome-title');
            const welcomeMessage = document.querySelector('.welcome-message');
            
            if (welcomeTitle && welcomeMessage) {
                const currentHour = new Date().getHours();
                let greeting = '';
                
                if (currentHour >= 5 && currentHour < 12) {
                    greeting = '좋은 아침입니다';
                } else if (currentHour >= 12 && currentHour < 18) {
                    greeting = '안녕하세요';
                } else {
                    greeting = '수고하십니다';
                }
                
                welcomeTitle.innerHTML = `👋 ${schoolInfo.admin}님, ${greeting}!`;
                welcomeMessage.innerHTML = `
                    ${schoolInfo.type} ${schoolInfo.name}의 현장실습보험 관리 시스템입니다.<br>
                    아래 메뉴를 통해 원하시는 서비스를 이용하세요.
                `;
            }
        }

       
    </script>
<!--	<script src="js/questionListSearch.js"></script>-->
	<script src="js/payment.js"></script> <!--    결제 --> 
	<script src="js/qcm-questions-manager.js"></script> <!--   질문서 리스트-->
    <script src="js/qcm-upload-manager.js"></script><!-- 질문서 업로드 관리자 -->
	<script src="js/qcm-questions-preview-manager.js"></script><!-- 질문서   미리보기 관리자 -->
	<script src="js/quote.js"></script>
	
	<script src="js/auto-logout-manager.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
	<script src="js/faq.js"></script>
</body>
</html>